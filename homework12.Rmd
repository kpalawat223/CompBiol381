---
title: "Homework 12"
author: "Kunal Palawat"
output:
  prettydoc::html_pretty:
    theme: cayman
    toc: no
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
Preliminaries
```{r}
library(readxl)
library(ggplot2)
library(ggthemes)
library(patchwork)
library(dplyr)
library(nlme)
library(wesanderson)
```

Read in and clean up Carbon and Nitrogen data for my soil samples.
```{r}
#load in data for year 1 and 2
fractionation_data <-  read_xlsx("Blowdown_soil_fractionation_Kunal_20180508.xlsx", sheet = 1, col_names = TRUE)

#cleaning up sheet, deleteing empty rows
fractionation_data <- fractionation_data[-15,1:16]
fractionation_data <- fractionation_data[-49,]
fractionation_data <- fractionation_data[-51:-52,]
fractionation_data <- fractionation_data[-61:-62,]

#make sure year is a factor
fractionation_data$Year <- as.factor(fractionation_data$Year)

#use dplyr to separate light and heavy fractions into different objects
fractionation_data_HF <- filter(fractionation_data, Fraction == "HF")
fractionation_data_LF <- filter(fractionation_data, Fraction == "LF")

str(fractionation_data)
str(fractionation_data_HF)
str(fractionation_data_LF)
```

For the Heavy Fraction Soils
Make Boxplots of Nitrogen Data
```{r}
#% N means by Site, Treatment, and Year
hf1 <- ggplot(data=fractionation_data_HF,
              mapping=aes(x=Site,
                          y=N,
                          color=Treatment,
                          fill=Year)) +
  geom_boxplot() +
  #scale_y_continuous(limits=c(.1,.8)) +
  theme_classic() +
  theme(legend.position = "none")+
  ggtitle("% N of Heavy Fraction Soils") +
  xlab("Site")+
  ylab("Percent Nitrogen")+
  scale_fill_manual(values=wes_palette(n=2, name="GrandBudapest2"))+
  scale_color_manual(values=c("slateblue","goldenrod","forestgreen","red"))
```

Make Boxplots of Carbon Data
```{r}
#% C means by Site, Treatment, and Year
hf2 <- ggplot(data=fractionation_data_HF,
              mapping=aes(x=Site,
                          y=C,
                          color=Treatment,
                          fill=Year)) +
  geom_boxplot() +
  #scale_y_continuous(limits=c(2.5,13)) +
  theme_classic() +
  theme(legend.position = "none")+
  ggtitle("% C of Heavy Fraction Soils") +
  xlab("Site")+
  ylab("Percent Carbon")+
  scale_fill_manual(values=wes_palette(n=2, name="GrandBudapest2"))+
  scale_color_manual(values=c("slateblue","goldenrod","forestgreen","red"))
```

Make Boxplots of C/N Ratio Data
```{r}
#C/N Ratio means by Site, Treatment, and Year
hf3 <- ggplot(data=fractionation_data_HF,
              mapping=aes(x=Site,
                          y=C/N,
                          color=Treatment,
                          fill=Year)) +
  geom_boxplot() +
  #scale_y_continuous(limits=c(12.5,18)) +
  theme_classic() +
  ggtitle("C/N Ratios of Heavy Fraction Soils") +
  xlab("Site")+
  ylab("C/N Ratio")+
  scale_fill_manual(values=wes_palette(n=2, name="GrandBudapest2"))+
  scale_color_manual(values=c("slateblue","goldenrod","forestgreen","red"))+
  annotate("text", x = 1.3, y = 17, label = "Year 2 values for site 3 don't \n show up because I have not \n input that data into \n my excel sheet yet!")
```

Show graphs together
```{r}
(hf1 | hf2) / hf3
```

Repeat the above code for the Light Fraction Soils
Make Boxplots of Nitrogen Data
```{r}
#% N means by Site, Treatment, and Year
lf1 <- ggplot(data=fractionation_data_LF,
              mapping=aes(x=Site,
                          y=N,
                          color=Treatment,
                          fill=Year)) +
  geom_boxplot() +
 # scale_y_continuous(limits=c()) +
  theme_classic() +
  theme(legend.position = "none")+
  ggtitle("% N of Light Fraction Soils") +
  xlab("Site")+
  ylab("Percent Nitrogen")+
  scale_fill_manual(values=wes_palette(n=2, name="GrandBudapest2"))+
  scale_color_manual(values=c("slateblue","goldenrod","forestgreen","red"))
```

Make Boxplots of Carbon Data
```{r}
#% C means by Site, Treatment, and Year
lf2 <- ggplot(data=fractionation_data_LF,
              mapping=aes(x=Site,
                          y=C,
                          color=Treatment,
                          fill=Year)) +
  geom_boxplot() +
 # scale_y_continuous(limits=c()) +
  theme_classic() +
  theme(legend.position = "none")+
  ggtitle("% C of Heavy Light Soils") +
  xlab("Site")+
  ylab("Percent Carbon")+
  scale_fill_manual(values=wes_palette(n=2, name="GrandBudapest2"))+
  scale_color_manual(values=c("slateblue","goldenrod","forestgreen","red"))
```

Make Boxplots of C/N Ratio Data
```{r}
#C/N Ratio means by Site, Treatment, and Year
lf3 <- ggplot(data=fractionation_data_LF,
              mapping=aes(x=Site,
                          y=C/N,
                          color=Treatment,
                          fill=Year)) +
  geom_boxplot() +
  #scale_y_continuous(limits=c()) +
  theme_classic() +
  ggtitle("C/N Ratios of Light Fraction Soils") +
  xlab("Site")+
  ylab("C/N Ratio")+
  scale_fill_manual(values=wes_palette(n=2, name="GrandBudapest2"))+
  scale_color_manual(values=c("slateblue","goldenrod","forestgreen","red"))+
  annotate("text", x = 2, y = 25, label = "This is my \n favorite graph!!")
```

Show graphs together
```{r}
(lf1 | lf2) / lf3
```

I absolutely love the patchwork library, and I could spend hours playing around with different color palettes and fill/color options to make the best graphs. ggplot is a real timesink!